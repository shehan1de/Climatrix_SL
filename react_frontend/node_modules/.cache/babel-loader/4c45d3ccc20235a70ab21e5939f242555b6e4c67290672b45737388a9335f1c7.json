{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\HP\\\\Desktop\\\\Assignments\\\\Nadil\\\\Final\\\\Climatrix\\\\react_frontend\\\\src\\\\pages\\\\client\\\\Predictions.js\",\n  _s = $RefreshSig$();\nimport axios from \"axios\";\nimport { useEffect, useState } from \"react\";\nimport logo from \"../../assets/logo.png\";\nimport Footer from \"../../components/Footer\";\nimport jsPDF from \"jspdf\";\n\n// ✅ Cities (from your dataset) — keep sorted\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CITY_OPTIONS = [\"Athurugiriya\", \"Badulla\", \"Bentota\", \"Colombo\", \"Galle\", \"Gampaha\", \"Hambantota\", \"Hatton\", \"Jaffna\", \"Kalmunai\", \"Kalutara\", \"Kandy\", \"Kesbewa\", \"Kolonnawa\", \"Kurunegala\", \"Mabole\", \"Maharagama\", \"Mannar\", \"Matale\", \"Matara\", \"Minuwangoda\", \"Moratuwa\", \"Mount Lavinia\", \"Negombo\", \"Oruwala\", \"Pothuhera\", \"Puttalam\", \"Ratnapura\", \"Sri Jayewardenepura Kotte\", \"Trincomalee\", \"Weligama\"];\n\n// Axios instance pointing to Flask backend\nconst API = axios.create({\n  baseURL: \"http://127.0.0.1:5000\",\n  headers: {\n    \"Content-Type\": \"application/json\"\n  }\n});\nconst ClientPredictions = () => {\n  _s();\n  const user = JSON.parse(localStorage.getItem(\"user\"));\n  const userId = user === null || user === void 0 ? void 0 : user.userId;\n  const [form, setForm] = useState({\n    city: \"\",\n    parameter: \"rain_sum\",\n    timeframe: \"week\",\n    min_or_max: \"max\"\n  });\n  const [alert, setAlert] = useState({\n    type: \"\",\n    message: \"\"\n  });\n  const [loading, setLoading] = useState(false);\n  const [result, setResult] = useState(null);\n\n  // Alert timeout\n  useEffect(() => {\n    if (alert.message) {\n      const timer = setTimeout(() => setAlert({\n        type: \"\",\n        message: \"\"\n      }), 3000);\n      return () => clearTimeout(timer);\n    }\n  }, [alert]);\n\n  // ✅ PDF generator (same style idea as history page, but no \":\" and centered)\n  const downloadPredictionPDF = async p => {\n    try {\n      const doc = new jsPDF(\"p\", \"mm\", \"a4\");\n      const pageW = doc.internal.pageSize.getWidth();\n      const marginX = 16;\n      let y = 16;\n\n      // --- Logo (top center) ---\n      // Convert imported logo to base64 via canvas\n      const logoBase64 = await new Promise(resolve => {\n        const img = new Image();\n        img.crossOrigin = \"anonymous\";\n        img.src = logo;\n        img.onload = () => {\n          const canvas = document.createElement(\"canvas\");\n          canvas.width = img.width;\n          canvas.height = img.height;\n          const ctx = canvas.getContext(\"2d\");\n          ctx.drawImage(img, 0, 0);\n          resolve(canvas.toDataURL(\"image/png\"));\n        };\n        img.onerror = () => resolve(null);\n      });\n      if (logoBase64) {\n        const imgW = 18;\n        const imgH = 18;\n        doc.addImage(logoBase64, \"PNG\", pageW / 2 - imgW / 2, y, imgW, imgH);\n      }\n      y += 26;\n\n      // --- Title (center) ---\n      doc.setFont(\"helvetica\", \"bold\");\n      doc.setFontSize(18);\n      doc.text(\"ClimatrixSL Prediction Report\", pageW / 2, y, {\n        align: \"center\"\n      });\n      y += 8;\n\n      // --- Sub title line (gradient vibe using green accent) ---\n      doc.setDrawColor(164, 198, 57); // #a4c639\n      doc.setLineWidth(0.8);\n      doc.line(marginX, y, pageW - marginX, y);\n      y += 12;\n\n      // --- Info block (center aligned labels) ---\n      const infoRows = [[\"City\", p.city], [\"Parameter\", p.parameter], [\"Timeframe\", p.timeframe], [\"Mode\", p.min_or_max], [\"Predicted Value\", String(p.predicted_value)], [\"Risk Level\", p.disaster_risk]];\n      const labelX = pageW / 2 - 38;\n      const valueX = pageW / 2 + 6;\n      doc.setFontSize(11);\n      infoRows.forEach(([label, value]) => {\n        doc.setFont(\"helvetica\", \"bold\");\n        doc.text(label, labelX, y, {\n          align: \"right\"\n        });\n        doc.setFont(\"helvetica\", \"normal\");\n        doc.text(value !== null && value !== void 0 ? value : \"—\", valueX, y, {\n          align: \"left\"\n        });\n        y += 7;\n      });\n      y += 6;\n\n      // --- Message section ---\n      if (p.forecast_message) {\n        doc.setFont(\"helvetica\", \"bold\");\n        doc.setFontSize(12);\n        doc.text(\"Forecast Summary\", pageW / 2, y, {\n          align: \"center\"\n        });\n        y += 8;\n        doc.setFont(\"helvetica\", \"normal\");\n        doc.setFontSize(10);\n        const msgLines = doc.splitTextToSize(p.forecast_message, pageW - marginX * 2);\n        doc.text(msgLines, marginX, y);\n        y += msgLines.length * 5 + 8;\n      }\n\n      // --- Plot (optional) ---\n      if (p.forecast_plot) {\n        const imgData = `data:image/png;base64,${p.forecast_plot}`;\n        const imgW = pageW - marginX * 2;\n        const imgH = 78;\n\n        // If near end, add new page\n        if (y + imgH > 280) {\n          doc.addPage();\n          y = 18;\n        }\n        doc.setFont(\"helvetica\", \"bold\");\n        doc.setFontSize(12);\n        doc.text(\"Forecast Chart\", pageW / 2, y, {\n          align: \"center\"\n        });\n        y += 6;\n        doc.addImage(imgData, \"PNG\", marginX, y, imgW, imgH);\n        y += imgH + 8;\n      }\n\n      // --- Footer ---\n      doc.setFont(\"helvetica\", \"normal\");\n      doc.setFontSize(9);\n      doc.setTextColor(150);\n      doc.text(\"Generated by ClimatrixSL\", pageW / 2, 292, {\n        align: \"center\"\n      });\n      doc.setTextColor(0);\n      const safeCity = String(p.city || \"prediction\").replace(/\\s+/g, \"_\");\n      doc.save(`Climatrix_${safeCity}_${Date.now()}.pdf`);\n    } catch (e) {\n      console.error(e);\n      setAlert({\n        type: \"error\",\n        message: \"PDF download failed. Make sure jspdf is installed.\"\n      });\n    }\n  };\n  const handleSubmit = async e => {\n    e.preventDefault();\n    if (!userId) {\n      setAlert({\n        type: \"error\",\n        message: \"User not logged in\"\n      });\n      return;\n    }\n    setLoading(true);\n    setResult(null);\n    try {\n      const payload = {\n        ...form,\n        userId\n      };\n      const res = await API.post(\"/predict\", payload);\n      setAlert({\n        type: \"success\",\n        message: \"Prediction generated! PDF downloading...\"\n      });\n      setResult(res.data);\n\n      // ✅ Auto-download PDF after prediction\n      await downloadPredictionPDF(res.data);\n\n      // Reset city only\n      setForm(prev => ({\n        ...prev,\n        city: \"\"\n      }));\n    } catch (err) {\n      var _err$response, _err$response$data;\n      console.error(err);\n      const msg = ((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.error) || \"Failed to generate prediction\";\n      setAlert({\n        type: \"error\",\n        message: msg\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"pred-page d-flex flex-column\",\n    children: [alert.message && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `login-alert ${alert.type === \"error\" ? \"login-alert-error\" : \"login-alert-success\"}`,\n      children: alert.message\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 239,\n      columnNumber: 9\n    }, this), loading && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"loading-overlay\",\n      children: /*#__PURE__*/_jsxDEV(\"img\", {\n        src: logo,\n        alt: \"Loading...\",\n        className: \"spinner-logo-large\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 251,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 250,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"pred-container flex-grow-1\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"pred-hero text-center text-white\",\n        children: /*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"pred-title\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"brand-gradient\",\n            children: \"Generate Prediction\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 259,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 258,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 257,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"pred-grid-single\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"pred-glass-card text-white\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            className: \"fw-bold mb-3\",\n            children: \"Prediction Form\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 266,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n            onSubmit: handleSubmit,\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"pred-label\",\n              children: \"City\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 270,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              className: \"form-control glass-input glass-select mb-3\",\n              required: true,\n              value: form.city,\n              onChange: e => setForm({\n                ...form,\n                city: e.target.value\n              }),\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"\",\n                disabled: true,\n                children: \"Select a city\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 277,\n                columnNumber: 17\n              }, this), CITY_OPTIONS.map(city => /*#__PURE__*/_jsxDEV(\"option\", {\n                value: city,\n                children: city\n              }, city, false, {\n                fileName: _jsxFileName,\n                lineNumber: 281,\n                columnNumber: 19\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 271,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"pred-label\",\n              children: \"Parameter\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 287,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              className: \"form-control glass-input glass-select mb-3\",\n              value: form.parameter,\n              onChange: e => setForm({\n                ...form,\n                parameter: e.target.value\n              }),\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"rain_sum\",\n                children: \"Rainfall\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 293,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"windspeed_10m_max\",\n                children: \"Wind Speed\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 294,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"windgusts_10m_max\",\n                children: \"Wind Gusts\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 295,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 288,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"pred-label\",\n              children: \"Timeframe\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 298,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              className: \"form-control glass-input glass-select mb-3\",\n              value: form.timeframe,\n              onChange: e => setForm({\n                ...form,\n                timeframe: e.target.value\n              }),\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"day\",\n                children: \"Day\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 304,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"week\",\n                children: \"Week\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 305,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"month\",\n                children: \"Month\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 306,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 299,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"pred-label\",\n              children: \"Mode\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 309,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              className: \"form-control glass-input glass-select mb-3\",\n              value: form.min_or_max,\n              onChange: e => setForm({\n                ...form,\n                min_or_max: e.target.value\n              }),\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"max\",\n                children: \"Maximum\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 315,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"min\",\n                children: \"Minimum\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 316,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 310,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"btn btn-green-custom w-100 py-2\",\n              type: \"submit\",\n              children: \"Generate Prediction\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 319,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 268,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 265,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"pred-glass-card text-white\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            className: \"fw-bold mb-3\",\n            children: \"Prediction Result\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 327,\n            columnNumber: 13\n          }, this), !result ? /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-white-50 mb-0 text-center\",\n            children: \"No result yet. Generate a prediction to see output here.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 330,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"pred-result-box\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"pred-result-row\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"pred-result-label\",\n                children: \"City\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 336,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"pred-result-value\",\n                children: result.city\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 337,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 335,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"pred-result-row\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"pred-result-label\",\n                children: \"Parameter\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 341,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"pred-result-value\",\n                children: result.parameter\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 342,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 340,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"pred-result-row\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"pred-result-label\",\n                children: \"Timeframe\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 346,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"pred-result-value\",\n                children: result.timeframe\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 347,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 345,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"pred-result-row\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"pred-result-label\",\n                children: \"Mode\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 351,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"pred-result-value\",\n                children: result.min_or_max\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 352,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 350,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"pred-result-row\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"pred-result-label\",\n                children: \"Predicted Value\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 356,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"pred-result-value fw-bold\",\n                children: result.predicted_value\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 357,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 355,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"pred-result-row\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"pred-result-label\",\n                children: \"Risk\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 363,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"pred-risk-chip\",\n                children: result.disaster_risk\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 364,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 362,\n              columnNumber: 17\n            }, this), result.forecast_message && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"pred-message mt-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Message\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 369,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-white-50\",\n                children: result.forecast_message\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 370,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 368,\n              columnNumber: 19\n            }, this), result.forecast_plot && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"mt-3 text-center\",\n              children: /*#__PURE__*/_jsxDEV(\"img\", {\n                src: `data:image/png;base64,${result.forecast_plot}`,\n                alt: \"Forecast Plot\",\n                className: \"pred-plot-img\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 376,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 375,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 334,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 326,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 263,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 389,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 236,\n    columnNumber: 5\n  }, this);\n};\n_s(ClientPredictions, \"mdaFV6h3hcwQ0Y+3dzDnxrNseMY=\");\n_c = ClientPredictions;\nexport default ClientPredictions;\nvar _c;\n$RefreshReg$(_c, \"ClientPredictions\");","map":{"version":3,"names":["axios","useEffect","useState","logo","Footer","jsPDF","jsxDEV","_jsxDEV","CITY_OPTIONS","API","create","baseURL","headers","ClientPredictions","_s","user","JSON","parse","localStorage","getItem","userId","form","setForm","city","parameter","timeframe","min_or_max","alert","setAlert","type","message","loading","setLoading","result","setResult","timer","setTimeout","clearTimeout","downloadPredictionPDF","p","doc","pageW","internal","pageSize","getWidth","marginX","y","logoBase64","Promise","resolve","img","Image","crossOrigin","src","onload","canvas","document","createElement","width","height","ctx","getContext","drawImage","toDataURL","onerror","imgW","imgH","addImage","setFont","setFontSize","text","align","setDrawColor","setLineWidth","line","infoRows","String","predicted_value","disaster_risk","labelX","valueX","forEach","label","value","forecast_message","msgLines","splitTextToSize","length","forecast_plot","imgData","addPage","setTextColor","safeCity","replace","save","Date","now","e","console","error","handleSubmit","preventDefault","payload","res","post","data","prev","err","_err$response","_err$response$data","msg","response","className","children","fileName","_jsxFileName","lineNumber","columnNumber","alt","onSubmit","required","onChange","target","disabled","map","_c","$RefreshReg$"],"sources":["C:/Users/HP/Desktop/Assignments/Nadil/Final/Climatrix/react_frontend/src/pages/client/Predictions.js"],"sourcesContent":["import axios from \"axios\";\nimport { useEffect, useState } from \"react\";\nimport logo from \"../../assets/logo.png\";\nimport Footer from \"../../components/Footer\";\nimport jsPDF from \"jspdf\";\n\n// ✅ Cities (from your dataset) — keep sorted\nconst CITY_OPTIONS = [\n  \"Athurugiriya\",\n  \"Badulla\",\n  \"Bentota\",\n  \"Colombo\",\n  \"Galle\",\n  \"Gampaha\",\n  \"Hambantota\",\n  \"Hatton\",\n  \"Jaffna\",\n  \"Kalmunai\",\n  \"Kalutara\",\n  \"Kandy\",\n  \"Kesbewa\",\n  \"Kolonnawa\",\n  \"Kurunegala\",\n  \"Mabole\",\n  \"Maharagama\",\n  \"Mannar\",\n  \"Matale\",\n  \"Matara\",\n  \"Minuwangoda\",\n  \"Moratuwa\",\n  \"Mount Lavinia\",\n  \"Negombo\",\n  \"Oruwala\",\n  \"Pothuhera\",\n  \"Puttalam\",\n  \"Ratnapura\",\n  \"Sri Jayewardenepura Kotte\",\n  \"Trincomalee\",\n  \"Weligama\"\n];\n\n// Axios instance pointing to Flask backend\nconst API = axios.create({\n  baseURL: \"http://127.0.0.1:5000\",\n  headers: { \"Content-Type\": \"application/json\" }\n});\n\nconst ClientPredictions = () => {\n  const user = JSON.parse(localStorage.getItem(\"user\"));\n  const userId = user?.userId;\n\n  const [form, setForm] = useState({\n    city: \"\",\n    parameter: \"rain_sum\",\n    timeframe: \"week\",\n    min_or_max: \"max\"\n  });\n\n  const [alert, setAlert] = useState({ type: \"\", message: \"\" });\n  const [loading, setLoading] = useState(false);\n  const [result, setResult] = useState(null);\n\n  // Alert timeout\n  useEffect(() => {\n    if (alert.message) {\n      const timer = setTimeout(() => setAlert({ type: \"\", message: \"\" }), 3000);\n      return () => clearTimeout(timer);\n    }\n  }, [alert]);\n\n  // ✅ PDF generator (same style idea as history page, but no \":\" and centered)\n  const downloadPredictionPDF = async (p) => {\n    try {\n      const doc = new jsPDF(\"p\", \"mm\", \"a4\");\n      const pageW = doc.internal.pageSize.getWidth();\n      const marginX = 16;\n\n      let y = 16;\n\n      // --- Logo (top center) ---\n      // Convert imported logo to base64 via canvas\n      const logoBase64 = await new Promise((resolve) => {\n        const img = new Image();\n        img.crossOrigin = \"anonymous\";\n        img.src = logo;\n        img.onload = () => {\n          const canvas = document.createElement(\"canvas\");\n          canvas.width = img.width;\n          canvas.height = img.height;\n          const ctx = canvas.getContext(\"2d\");\n          ctx.drawImage(img, 0, 0);\n          resolve(canvas.toDataURL(\"image/png\"));\n        };\n        img.onerror = () => resolve(null);\n      });\n\n      if (logoBase64) {\n        const imgW = 18;\n        const imgH = 18;\n        doc.addImage(logoBase64, \"PNG\", pageW / 2 - imgW / 2, y, imgW, imgH);\n      }\n\n      y += 26;\n\n      // --- Title (center) ---\n      doc.setFont(\"helvetica\", \"bold\");\n      doc.setFontSize(18);\n      doc.text(\"ClimatrixSL Prediction Report\", pageW / 2, y, { align: \"center\" });\n\n      y += 8;\n\n      // --- Sub title line (gradient vibe using green accent) ---\n      doc.setDrawColor(164, 198, 57); // #a4c639\n      doc.setLineWidth(0.8);\n      doc.line(marginX, y, pageW - marginX, y);\n\n      y += 12;\n\n      // --- Info block (center aligned labels) ---\n      const infoRows = [\n        [\"City\", p.city],\n        [\"Parameter\", p.parameter],\n        [\"Timeframe\", p.timeframe],\n        [\"Mode\", p.min_or_max],\n        [\"Predicted Value\", String(p.predicted_value)],\n        [\"Risk Level\", p.disaster_risk]\n      ];\n\n      const labelX = pageW / 2 - 38;\n      const valueX = pageW / 2 + 6;\n\n      doc.setFontSize(11);\n\n      infoRows.forEach(([label, value]) => {\n        doc.setFont(\"helvetica\", \"bold\");\n        doc.text(label, labelX, y, { align: \"right\" });\n\n        doc.setFont(\"helvetica\", \"normal\");\n        doc.text(value ?? \"—\", valueX, y, { align: \"left\" });\n\n        y += 7;\n      });\n\n      y += 6;\n\n      // --- Message section ---\n      if (p.forecast_message) {\n        doc.setFont(\"helvetica\", \"bold\");\n        doc.setFontSize(12);\n        doc.text(\"Forecast Summary\", pageW / 2, y, { align: \"center\" });\n\n        y += 8;\n\n        doc.setFont(\"helvetica\", \"normal\");\n        doc.setFontSize(10);\n\n        const msgLines = doc.splitTextToSize(p.forecast_message, pageW - marginX * 2);\n        doc.text(msgLines, marginX, y);\n\n        y += msgLines.length * 5 + 8;\n      }\n\n      // --- Plot (optional) ---\n      if (p.forecast_plot) {\n        const imgData = `data:image/png;base64,${p.forecast_plot}`;\n\n        const imgW = pageW - marginX * 2;\n        const imgH = 78;\n\n        // If near end, add new page\n        if (y + imgH > 280) {\n          doc.addPage();\n          y = 18;\n        }\n\n        doc.setFont(\"helvetica\", \"bold\");\n        doc.setFontSize(12);\n        doc.text(\"Forecast Chart\", pageW / 2, y, { align: \"center\" });\n        y += 6;\n\n        doc.addImage(imgData, \"PNG\", marginX, y, imgW, imgH);\n        y += imgH + 8;\n      }\n\n      // --- Footer ---\n      doc.setFont(\"helvetica\", \"normal\");\n      doc.setFontSize(9);\n      doc.setTextColor(150);\n      doc.text(\"Generated by ClimatrixSL\", pageW / 2, 292, { align: \"center\" });\n      doc.setTextColor(0);\n\n      const safeCity = String(p.city || \"prediction\").replace(/\\s+/g, \"_\");\n      doc.save(`Climatrix_${safeCity}_${Date.now()}.pdf`);\n    } catch (e) {\n      console.error(e);\n      setAlert({\n        type: \"error\",\n        message: \"PDF download failed. Make sure jspdf is installed.\"\n      });\n    }\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n\n    if (!userId) {\n      setAlert({ type: \"error\", message: \"User not logged in\" });\n      return;\n    }\n\n    setLoading(true);\n    setResult(null);\n\n    try {\n      const payload = { ...form, userId };\n      const res = await API.post(\"/predict\", payload);\n\n      setAlert({ type: \"success\", message: \"Prediction generated! PDF downloading...\" });\n      setResult(res.data);\n\n      // ✅ Auto-download PDF after prediction\n      await downloadPredictionPDF(res.data);\n\n      // Reset city only\n      setForm((prev) => ({ ...prev, city: \"\" }));\n    } catch (err) {\n      console.error(err);\n      const msg = err.response?.data?.error || \"Failed to generate prediction\";\n      setAlert({ type: \"error\", message: msg });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"pred-page d-flex flex-column\">\n      {/* Alerts */}\n      {alert.message && (\n        <div\n          className={`login-alert ${\n            alert.type === \"error\" ? \"login-alert-error\" : \"login-alert-success\"\n          }`}\n        >\n          {alert.message}\n        </div>\n      )}\n\n      {/* Loading */}\n      {loading && (\n        <div className=\"loading-overlay\">\n          <img src={logo} alt=\"Loading...\" className=\"spinner-logo-large\" />\n        </div>\n      )}\n\n      {/* Content */}\n      <div className=\"pred-container flex-grow-1\">\n        <div className=\"pred-hero text-center text-white\">\n          <h1 className=\"pred-title\">\n            <span className=\"brand-gradient\">Generate Prediction</span>\n          </h1>\n        </div>\n\n        <div className=\"pred-grid-single\">\n          {/* Form */}\n          <div className=\"pred-glass-card text-white\">\n            <h4 className=\"fw-bold mb-3\">Prediction Form</h4>\n\n            <form onSubmit={handleSubmit}>\n              {/* ✅ City dropdown */}\n              <label className=\"pred-label\">City</label>\n              <select\n                className=\"form-control glass-input glass-select mb-3\"\n                required\n                value={form.city}\n                onChange={(e) => setForm({ ...form, city: e.target.value })}\n              >\n                <option value=\"\" disabled>\n                  Select a city\n                </option>\n                {CITY_OPTIONS.map((city) => (\n                  <option key={city} value={city}>\n                    {city}\n                  </option>\n                ))}\n              </select>\n\n              <label className=\"pred-label\">Parameter</label>\n              <select\n                className=\"form-control glass-input glass-select mb-3\"\n                value={form.parameter}\n                onChange={(e) => setForm({ ...form, parameter: e.target.value })}\n              >\n                <option value=\"rain_sum\">Rainfall</option>\n                <option value=\"windspeed_10m_max\">Wind Speed</option>\n                <option value=\"windgusts_10m_max\">Wind Gusts</option>\n              </select>\n\n              <label className=\"pred-label\">Timeframe</label>\n              <select\n                className=\"form-control glass-input glass-select mb-3\"\n                value={form.timeframe}\n                onChange={(e) => setForm({ ...form, timeframe: e.target.value })}\n              >\n                <option value=\"day\">Day</option>\n                <option value=\"week\">Week</option>\n                <option value=\"month\">Month</option>\n              </select>\n\n              <label className=\"pred-label\">Mode</label>\n              <select\n                className=\"form-control glass-input glass-select mb-3\"\n                value={form.min_or_max}\n                onChange={(e) => setForm({ ...form, min_or_max: e.target.value })}\n              >\n                <option value=\"max\">Maximum</option>\n                <option value=\"min\">Minimum</option>\n              </select>\n\n              <button className=\"btn btn-green-custom w-100 py-2\" type=\"submit\">\n                Generate Prediction\n              </button>\n            </form>\n          </div>\n\n          {/* Result */}\n          <div className=\"pred-glass-card text-white\">\n            <h4 className=\"fw-bold mb-3\">Prediction Result</h4>\n\n            {!result ? (\n              <p className=\"text-white-50 mb-0 text-center\">\n                No result yet. Generate a prediction to see output here.\n              </p>\n            ) : (\n              <div className=\"pred-result-box\">\n                <div className=\"pred-result-row\">\n                  <span className=\"pred-result-label\">City</span>\n                  <span className=\"pred-result-value\">{result.city}</span>\n                </div>\n\n                <div className=\"pred-result-row\">\n                  <span className=\"pred-result-label\">Parameter</span>\n                  <span className=\"pred-result-value\">{result.parameter}</span>\n                </div>\n\n                <div className=\"pred-result-row\">\n                  <span className=\"pred-result-label\">Timeframe</span>\n                  <span className=\"pred-result-value\">{result.timeframe}</span>\n                </div>\n\n                <div className=\"pred-result-row\">\n                  <span className=\"pred-result-label\">Mode</span>\n                  <span className=\"pred-result-value\">{result.min_or_max}</span>\n                </div>\n\n                <div className=\"pred-result-row\">\n                  <span className=\"pred-result-label\">Predicted Value</span>\n                  <span className=\"pred-result-value fw-bold\">\n                    {result.predicted_value}\n                  </span>\n                </div>\n\n                <div className=\"pred-result-row\">\n                  <span className=\"pred-result-label\">Risk</span>\n                  <span className=\"pred-risk-chip\">{result.disaster_risk}</span>\n                </div>\n\n                {result.forecast_message && (\n                  <div className=\"pred-message mt-3\">\n                    <strong>Message</strong>\n                    <div className=\"text-white-50\">{result.forecast_message}</div>\n                  </div>\n                )}\n\n                {result.forecast_plot && (\n                  <div className=\"mt-3 text-center\">\n                    <img\n                      src={`data:image/png;base64,${result.forecast_plot}`}\n                      alt=\"Forecast Plot\"\n                      className=\"pred-plot-img\"\n                    />\n                  </div>\n                )}\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n\n      <Footer />\n    </div>\n  );\n};\n\nexport default ClientPredictions;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}